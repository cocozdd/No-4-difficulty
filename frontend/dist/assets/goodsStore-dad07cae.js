import{C as u,D as y,v as c}from"./index-bb0676e0.js";const p=e=>u.get("/goods",{params:e}),w=e=>u.get(`/goods/${e}`),$=e=>u.post("/goods",e),P=()=>u.get("/goods/mine"),x=(e,s)=>u.put(`/goods/${e}`,s),D=e=>u.delete(`/goods/${e}`),h=()=>u.get("/goods/pending"),I=(e,s)=>u.put(`/goods/${e}/review`,s),L=y("goodsStore",()=>{const e=c([]),s=c([]),v=c([]),i=c(!1),n=c(null),r=c(!1),G=async o=>{i.value=!0;try{const{data:a}=await p(o);e.value=a}finally{i.value=!1}},f=async o=>{n.value=null;const{data:a}=await w(o);n.value=a},g=o=>{var d;if(o.status==="APPROVED"){const t=e.value.some(l=>l.id===o.id);e.value=t?e.value.map(l=>l.id===o.id?o:l):[o,...e.value]}else e.value=e.value.filter(t=>t.id!==o.id);s.value.findIndex(t=>t.id===o.id)>=0&&(s.value=s.value.map(t=>t.id===o.id?o:t)),((d=n.value)==null?void 0:d.id)===o.id&&(n.value=o)};return{goods:e,myGoods:s,pendingGoods:v,loading:i,pendingLoading:r,selectedGoods:n,loadGoods:G,loadGoodsById:f,createGoods:async o=>{const{data:a}=await $(o);return a.status==="APPROVED"&&(e.value=[a,...e.value]),s.value=[a,...s.value],a},loadMyGoods:async()=>{const{data:o}=await P();s.value=o},loadPendingGoods:async()=>{r.value=!0;try{const{data:o}=await h();v.value=o}finally{r.value=!1}},reviewGoods:async(o,a)=>{const{data:d}=await I(o,{status:a});return v.value=v.value.filter(t=>t.id!==o),g(d),d},updateGoods:async(o,a)=>{var t;const{data:d}=await x(o,a);return e.value=d.status==="APPROVED"?e.value.map(l=>l.id===o?d:l):e.value.filter(l=>l.id!==o),s.value=s.value.map(l=>l.id===o?d:l),((t=n.value)==null?void 0:t.id)===o&&(n.value=d),d},deleteGoods:async o=>{var a;await D(o),e.value=e.value.filter(d=>d.id!==o),s.value=s.value.filter(d=>d.id!==o),((a=n.value)==null?void 0:a.id)===o&&(n.value=null)}}});export{L as u};
