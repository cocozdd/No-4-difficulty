import{u as P}from"./goodsStore-dad07cae.js";import{f as x}from"./date-4ca18749.js";import{d as S,m as V,o as L,r as c,A as G,a as I,e as t,w as o,f as h,b as v,k as r,g as p,j as k,B as N,t as u,E as A,p as $,i as B,_ as T}from"./index-bb0676e0.js";const j=_=>($("data-v-b5f4e167"),_=_(),B(),_),O={class:"admin-review-view"},z={class:"header-content"},F=j(()=>v("h2",null,"Pending Listings",-1)),J={class:"header-actions"},M=S({__name:"AdminReviewView",setup(_){const i=P(),g=V({}),w=(l,a)=>`${l}-${a}`,b=(l,a)=>g[w(l,a)]===!0,y=async(l,a)=>{var m,n;const d=w(l,a);if(!g[d]){g[d]=!0;try{const s=await i.reviewGoods(l,a);A.success(a==="APPROVED"?`Listing "${s.title}" approved`:`Listing "${s.title}" rejected`)}catch(s){const f=((n=(m=s==null?void 0:s.response)==null?void 0:m.data)==null?void 0:n.message)||"Failed to process review";A.error(f)}finally{g[d]=!1}}},C=()=>i.loadPendingGoods();return L(()=>{i.loadPendingGoods()}),(l,a)=>{const d=c("el-button"),m=c("el-empty"),n=c("el-table-column"),s=c("el-space"),f=c("el-table"),E=c("el-card"),R=G("loading");return h(),I("div",O,[t(E,{class:"review-card"},{header:o(()=>[v("div",z,[F,v("div",J,[t(d,{type:"primary",text:"",onClick:C,loading:r(i).pendingLoading},{default:o(()=>[p(" Refresh ")]),_:1},8,["loading"])])])]),default:o(()=>[!r(i).pendingLoading&&!r(i).pendingGoods.length?(h(),k(m,{key:0,description:"No pending listings ðŸŽ‰"})):N((h(),k(f,{key:1,data:r(i).pendingGoods,border:"",style:{width:"100%"}},{default:o(()=>[t(n,{prop:"title",label:"Title","min-width":"180"}),t(n,{prop:"category",label:"Category",width:"140"}),t(n,{prop:"price",label:"Price (CNY)",width:"140"},{default:o(({row:e})=>[p(u(e.price.toFixed(2)),1)]),_:1}),t(n,{label:"Seller","min-width":"160"},{default:o(({row:e})=>[p(u(e.sellerNickname)+" (ID: "+u(e.sellerId)+") ",1)]),_:1}),t(n,{prop:"publishedAt",label:"Submitted At","min-width":"200"},{default:o(({row:e})=>[p(u(r(x)(e.publishedAt)),1)]),_:1}),t(n,{label:"Actions",width:"220",fixed:"right"},{default:o(({row:e})=>[t(s,null,{default:o(()=>[t(d,{size:"small",type:"success",plain:"",onClick:D=>y(e.id,"APPROVED"),loading:b(e.id,"APPROVED")},{default:o(()=>[p(" Approve ")]),_:2},1032,["onClick","loading"]),t(d,{size:"small",type:"danger",plain:"",onClick:D=>y(e.id,"REJECTED"),loading:b(e.id,"REJECTED")},{default:o(()=>[p(" Reject ")]),_:2},1032,["onClick","loading"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[R,r(i).pendingLoading]])]),_:1})])}}});const H=T(M,[["__scopeId","data-v-b5f4e167"]]);export{H as default};
