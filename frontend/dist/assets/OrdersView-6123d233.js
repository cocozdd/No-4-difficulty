import{u as z}from"./orderStore-69d556d9.js";import{d as F,v as U,b as Y,o as j,e as c,f as h,m as y,l as d,j as m,h as r,i as s,n as l,F as q,k as J,g as a,t as E,p as o,B as K,q as Q,s as W,E as S,_ as X}from"./index-1ba1cfa6.js";import"./goodsStore-a546335a.js";const D=g=>(Q("data-v-78e5f68e"),g=g(),W(),g),Z={class:"orders-view"},ee=D(()=>a("h1",null,"Order Collaboration Hub",-1)),te={class:"card-header"},se={class:"order-body"},ae=["src"],ne={class:"info"},le={class:"card-actions"},oe=D(()=>a("p",null,"Select the payment outcome to continue the practice flow.",-1)),ie={class:"dialog-footer"},ce="https://dummyimage.com/400x240/f2f6ff/8ca8ff.png&text=No+Image",re=F({__name:"OrdersView",setup(g){const p=z(),k=U(),n=Y({visible:!1,orderId:null});j(()=>{p.loadOrders()});const N=e=>e.buyerId===k.userId,v=e=>e.sellerId===k.userId,b=e=>N(e)&&e.status==="PENDING_PAYMENT",w=e=>N(e)&&e.status==="PENDING_PAYMENT",T=e=>v(e)&&e.status==="PENDING_SHIPMENT",V=e=>N(e)&&e.status==="PENDING_RECEIVE",M=e=>({PENDING_PAYMENT:"Pending Payment",PENDING_SHIPMENT:"Pending Shipment",PENDING_RECEIVE:"Pending Receipt",COMPLETED:"Completed",CANCELED:"Canceled"})[e]||e,O=e=>{switch(e){case"PENDING_PAYMENT":return"warning";case"PENDING_SHIPMENT":return"info";case"PENDING_RECEIVE":return"warning";case"COMPLETED":return"success";case"CANCELED":return"danger";default:return"info"}},f=async(e,u)=>{var C,I;try{await p.changeOrderStatus(e,{status:u}),S.success("Order status updated")}catch(_){const i=((I=(C=_==null?void 0:_.response)==null?void 0:C.data)==null?void 0:I.message)||"Update failed";S.error(i)}},G=e=>{n.orderId=e,n.visible=!0},x=async()=>{n.orderId!=null&&(await f(n.orderId,"PENDING_SHIPMENT"),n.visible=!1)},A=async()=>{n.orderId!=null&&(await f(n.orderId,"CANCELED"),n.visible=!1)};return(e,u)=>{const C=c("el-empty"),I=c("el-skeleton-item"),_=c("el-tag"),i=c("el-button"),L=c("el-card"),B=c("el-timeline-item"),R=c("el-timeline"),H=c("el-skeleton"),$=c("el-dialog");return l(),h("div",Z,[ee,!y(p).orders.length&&!y(p).loading?(l(),d(C,{key:0,description:"No related orders yet"})):m("",!0),r(H,{loading:y(p).loading,animated:""},{template:s(()=>[r(I,{variant:"rect",style:{width:"100%",height:"120px","margin-bottom":"16px"}})]),default:s(()=>[r(R,null,{default:s(()=>[(l(!0),h(q,null,J(y(p).orders,t=>(l(),d(B,{key:t.id,timestamp:y(K)(t.createdAt),placement:"top"},{default:s(()=>[r(L,{class:"order-card"},{default:s(()=>[a("div",te,[a("div",null,[a("span",null,"Order #"+E(t.id),1),N(t)?(l(),d(_,{key:0,class:"role-tag",type:"primary"},{default:s(()=>[o("Buyer")]),_:1})):m("",!0),v(t)?(l(),d(_,{key:1,class:"role-tag",type:"success"},{default:s(()=>[o("Seller")]),_:1})):m("",!0)]),r(_,{type:O(t.status)},{default:s(()=>[o(E(M(t.status)),1)]),_:2},1032,["type"])]),a("div",se,[a("img",{src:t.goodsCoverImageUrl||ce,alt:"",class:"goods-cover"},null,8,ae),a("div",ne,[a("h3",null,E(t.goodsTitle),1),a("p",null,"Buyer: "+E(t.buyerNickname),1),a("p",null,"Seller: "+E(t.sellerNickname),1)])]),a("div",le,[b(t)?(l(),d(i,{key:0,size:"small",type:"primary",onClick:P=>G(t.id)},{default:s(()=>[o(" Simulate Payment ")]),_:2},1032,["onClick"])):m("",!0),w(t)?(l(),d(i,{key:1,size:"small",type:"danger",onClick:P=>f(t.id,"CANCELED")},{default:s(()=>[o(" Cancel Order ")]),_:2},1032,["onClick"])):m("",!0),T(t)?(l(),d(i,{key:2,size:"small",type:"warning",onClick:P=>f(t.id,"PENDING_RECEIVE")},{default:s(()=>[o(" Confirm Shipment ")]),_:2},1032,["onClick"])):m("",!0),V(t)?(l(),d(i,{key:3,size:"small",type:"success",onClick:P=>f(t.id,"COMPLETED")},{default:s(()=>[o(" Confirm Receipt ")]),_:2},1032,["onClick"])):m("",!0)])]),_:2},1024)]),_:2},1032,["timestamp"]))),128))]),_:1})]),_:1},8,["loading"]),r($,{modelValue:n.visible,"onUpdate:modelValue":u[1]||(u[1]=t=>n.visible=t),title:"Payment Simulation",width:"360px"},{footer:s(()=>[a("span",ie,[r(i,{onClick:u[0]||(u[0]=t=>n.visible=!1)},{default:s(()=>[o("Cancel")]),_:1}),r(i,{type:"danger",onClick:A},{default:s(()=>[o("Payment Failed")]),_:1}),r(i,{type:"primary",onClick:x},{default:s(()=>[o("Payment Succeeded")]),_:1})])]),default:s(()=>[oe]),_:1},8,["modelValue"])])}}});const me=X(re,[["__scopeId","data-v-78e5f68e"]]);export{me as default};
