import{u as P}from"./goodsStore-c6f4904d.js";import{d as x,b as S,o as V,e as c,L,f as G,h as e,i as o,n as v,g as f,m as r,p,l as k,M as I,t as u,B as N,E as C,q as $,s as B,_ as T}from"./index-4373494d.js";const M=_=>($("data-v-89270007"),_=_(),B(),_),O={class:"admin-review-view"},j={class:"header-content"},q=M(()=>f("h2",null,"Pending Listings",-1)),z={class:"header-actions"},F=x({__name:"AdminReviewView",setup(_){const i=P(),g=S({}),w=(l,a)=>`${l}-${a}`,y=(l,a)=>g[w(l,a)]===!0,b=async(l,a)=>{var m,n;const d=w(l,a);if(!g[d]){g[d]=!0;try{const s=await i.reviewGoods(l,a);C.success(a==="APPROVED"?`Listing "${s.title}" approved`:`Listing "${s.title}" rejected`)}catch(s){const h=((n=(m=s==null?void 0:s.response)==null?void 0:m.data)==null?void 0:n.message)||"Failed to process review";C.error(h)}finally{g[d]=!1}}},E=()=>i.loadPendingGoods();return V(()=>{i.loadPendingGoods()}),(l,a)=>{const d=c("el-button"),m=c("el-empty"),n=c("el-table-column"),s=c("el-space"),h=c("el-table"),R=c("el-card"),A=L("loading");return v(),G("div",O,[e(R,{class:"review-card"},{header:o(()=>[f("div",j,[q,f("div",z,[e(d,{type:"primary",text:"",onClick:E,loading:r(i).pendingLoading},{default:o(()=>[p(" Refresh ")]),_:1},8,["loading"])])])]),default:o(()=>[!r(i).pendingLoading&&!r(i).pendingGoods.length?(v(),k(m,{key:0,description:"No pending listings ðŸŽ‰"})):I((v(),k(h,{key:1,data:r(i).pendingGoods,border:"",style:{width:"100%"}},{default:o(()=>[e(n,{prop:"title",label:"Title","min-width":"180"}),e(n,{prop:"category",label:"Category",width:"140"}),e(n,{prop:"price",label:"Price (CNY)",width:"140"},{default:o(({row:t})=>[p(u(t.price.toFixed(2)),1)]),_:1}),e(n,{prop:"quantity",label:"Quantity",width:"120"}),e(n,{label:"Seller","min-width":"160"},{default:o(({row:t})=>[p(u(t.sellerNickname)+" (ID: "+u(t.sellerId)+") ",1)]),_:1}),e(n,{prop:"publishedAt",label:"Submitted At","min-width":"200"},{default:o(({row:t})=>[p(u(r(N)(t.publishedAt)),1)]),_:1}),e(n,{label:"Actions",width:"220",fixed:"right"},{default:o(({row:t})=>[e(s,null,{default:o(()=>[e(d,{size:"small",type:"success",plain:"",onClick:D=>b(t.id,"APPROVED"),loading:y(t.id,"APPROVED")},{default:o(()=>[p(" Approve ")]),_:2},1032,["onClick","loading"]),e(d,{size:"small",type:"danger",plain:"",onClick:D=>b(t.id,"REJECTED"),loading:y(t.id,"REJECTED")},{default:o(()=>[p(" Reject ")]),_:2},1032,["onClick","loading"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[A,r(i).pendingLoading]])]),_:1})])}}});const Q=T(F,[["__scopeId","data-v-89270007"]]);export{Q as default};
