import{d as E,u as B,s as N,l as S,v as p,m as v,r as u,a as T,e,w as a,f as A,g as y,E as k,_ as I}from"./index-bb0676e0.js";const M={class:"auth-view"},$=E({__name:"LoginView",setup(j){const R=B(),U=N(),i=S(),c=p("login"),d=p(!1),_=p(),g=p(),n=v({username:"",password:""}),o=v({username:"",password:"",nickname:"",phone:""}),q={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},h={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],nickname:[{required:!0,message:"请输入昵称",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"手机号格式不正确",trigger:"blur"}]},f=()=>{const s=U.query.redirect;R.push(s||"/")},x=()=>{var s;(s=_.value)==null||s.validate(async l=>{if(l){d.value=!0;try{await i.login(n.username,n.password),k.success("登录成功"),f()}finally{d.value=!1}}})},F=()=>{var s;(s=g.value)==null||s.validate(async l=>{if(l){d.value=!0;try{await i.register(o.username,o.password,o.nickname,o.phone),k.success("注册成功，已自动登录"),f()}finally{d.value=!1}}})};return(s,l)=>{const m=u("el-input"),t=u("el-form-item"),b=u("el-button"),V=u("el-form"),w=u("el-tab-pane"),C=u("el-tabs"),L=u("el-card");return A(),T("div",M,[e(L,{class:"auth-card"},{default:a(()=>[e(C,{modelValue:c.value,"onUpdate:modelValue":l[6]||(l[6]=r=>c.value=r)},{default:a(()=>[e(w,{label:"登录",name:"login"},{default:a(()=>[e(V,{model:n,rules:q,ref_key:"loginFormRef",ref:_,"label-position":"top"},{default:a(()=>[e(t,{label:"用户名",prop:"username"},{default:a(()=>[e(m,{modelValue:n.username,"onUpdate:modelValue":l[0]||(l[0]=r=>n.username=r),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),e(t,{label:"密码",prop:"password"},{default:a(()=>[e(m,{modelValue:n.password,"onUpdate:modelValue":l[1]||(l[1]=r=>n.password=r),placeholder:"请输入密码",type:"password"},null,8,["modelValue"])]),_:1}),e(t,null,{default:a(()=>[e(b,{type:"primary",loading:d.value,onClick:x,block:""},{default:a(()=>[y(" 登录 ")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1}),e(w,{label:"注册",name:"register"},{default:a(()=>[e(V,{model:o,rules:h,ref_key:"registerFormRef",ref:g,"label-position":"top"},{default:a(()=>[e(t,{label:"用户名",prop:"username"},{default:a(()=>[e(m,{modelValue:o.username,"onUpdate:modelValue":l[2]||(l[2]=r=>o.username=r),placeholder:"6-20位字母或数字"},null,8,["modelValue"])]),_:1}),e(t,{label:"密码",prop:"password"},{default:a(()=>[e(m,{modelValue:o.password,"onUpdate:modelValue":l[3]||(l[3]=r=>o.password=r),type:"password",placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),e(t,{label:"昵称",prop:"nickname"},{default:a(()=>[e(m,{modelValue:o.nickname,"onUpdate:modelValue":l[4]||(l[4]=r=>o.nickname=r),placeholder:"请输入昵称"},null,8,["modelValue"])]),_:1}),e(t,{label:"手机号",prop:"phone"},{default:a(()=>[e(m,{modelValue:o.phone,"onUpdate:modelValue":l[5]||(l[5]=r=>o.phone=r),placeholder:"请输入手机号"},null,8,["modelValue"])]),_:1}),e(t,null,{default:a(()=>[e(b,{type:"primary",loading:d.value,onClick:F,block:""},{default:a(()=>[y(" 注册并登录 ")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])}}});const D=I($,[["__scopeId","data-v-0e65c6a4"]]);export{D as default};
